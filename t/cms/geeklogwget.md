Geeklogのページをwgetで静的ページに
=====

Update: 2010-03-07



このサイトを DokuWiki と Movable Type に移動して ( 2011-01 にまた Google sites と Blogger に引っ越し ) 後に残された Geeklog のページを、 wget 使って静的ページに移行しました。これで MySQL がいらなくなります。単純に「ダウンロードしてアップロードして終わり」というわけにはいかないのですが、今回の手順をスクリプトで自動化すれば、サーバの負荷の低減のために Blog系CMS や Wiki のページを静的コンテンツとして公開することも難しくなさそうです。

## wget でダウンロード

`wget -m -k -p -E www.michinobu.jp`



でダウンロードしました。それぞれのパラメータの意味は



`wget --help`



など参照してください。ダウンロードした後、仮想ディレクトリなど、不要なものをを削除します。

## アップロード

テスト用のディレクトリを作成してアップロードしました。私の環境の場合、仮想ホストの設定などは自由にできるので、テスト用のディレクトリを test.michinobu.jp としました。自分の PC の hosts に test.michinobu.jp を追加して、ブラウザで表示できることを確認します。

## 足りないものを追加

wget は CSS の中の URL までは追いかけてくれないようです。インクルードしている CSS ファイルや background-image に指定している画像ファイルなどを所定の場所に追加します。私の場合、元のサイトのディレクトリからサブディレクトリごとまとめてコピーで済みました。次のディレクトリです。

*   images
*   layout

これで、見た目は OK。

## その他の微調整

お問い合わせページは、 Movable Type のサイトに作ったものにリダイレクトするように修正。 http://blog.michinobu.jp/mail.php これは、 Movable Type で問い合わせページ と同じもの。



外部リンクがなぜか相対パスになっているのを修正。これは wget のパラメータが不適切だったのが原因ではないだろうか。
